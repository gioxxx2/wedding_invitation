# 来宾信息查看和管理指南

## 新方案说明

由于腾讯文档没有公开 API，我们提供了一个**更好的解决方案**：

✅ **数据自动保存** - 所有来宾信息自动保存到浏览器本地存储  
✅ **专用查看页面** - 可以随时查看、统计和管理所有数据  
✅ **数据导出** - 支持导出 CSV 和 JSON 格式  
✅ **实时统计** - 显示总人数、总来宾数、收到祝福数等统计信息  

## 如何使用

### 1. 查看来宾信息

**方法一：从请柬页面进入**
- 在请柬页面底部，点击 **"📊 查看来宾信息"** 按钮
- 会自动打开数据查看页面

**方法二：直接访问**
- 访问：`https://gioxxx2.github.io/wedding_invitation/data-viewer.html`
- 或本地打开：`data-viewer.html` 文件

### 2. 数据查看页面功能

#### 📊 统计信息
页面顶部显示三个统计卡片：
- **总人数**：提交信息的来宾数量
- **总来宾数**：所有来宾的参加人数总和
- **收到祝福**：填写了祝福语的来宾数量

#### 📋 数据表格
显示所有来宾的详细信息：
- 序号
- 姓名
- 电话
- 参加人数
- 祝福语（鼠标悬停可查看完整内容）
- 提交时间

#### 🔄 数据管理
- **📥 导出 CSV**：导出为 CSV 文件，可以用 Excel 打开
- **📥 导出 JSON**：导出为 JSON 文件，用于数据备份
- **🔄 刷新数据**：重新加载最新数据
- **🏠 返回请柬**：返回主页面
- **🗑️ 清空数据**：删除所有数据（需要二次确认）

## 数据存储说明

### 存储位置
- 所有数据保存在**浏览器本地存储**（LocalStorage）中
- 数据不会上传到服务器，保护隐私
- 即使关闭浏览器，数据也不会丢失

### 数据格式
```json
{
  "name": "张三",
  "phone": "13800138000",
  "count": "2",
  "blessing": "祝你们幸福！",
  "timestamp": "2024-12-20T10:30:00.000Z"
}
```

## 数据导出

### 导出 CSV
1. 点击 **"📥 导出 CSV"** 按钮
2. 文件会自动下载
3. 可以用 Excel、WPS 等软件打开
4. 也可以导入到腾讯文档、Google Sheets 等在线表格

### 导出 JSON
1. 点击 **"📥 导出 JSON"** 按钮
2. 文件会自动下载
3. 用于数据备份或程序处理

## 数据备份建议

### 定期备份
建议定期（如每天）导出数据作为备份：
1. 点击 **"📥 导出 CSV"** 或 **"📥 导出 JSON"**
2. 保存到安全的位置（如云盘、电脑硬盘）

### 多设备同步
如果需要在不同设备上查看数据：
1. 在一台设备上导出数据
2. 在另一台设备上导入（需要手动实现，或使用云存储）

## 常见问题

### Q: 数据会丢失吗？
A: 不会。数据保存在浏览器本地存储中，除非：
- 手动清空浏览器数据
- 使用"清空数据"功能
- 使用浏览器的"清除网站数据"功能

### Q: 可以在手机上查看吗？
A: 可以！数据查看页面支持响应式设计，可以在手机、平板、电脑上正常查看。

### Q: 如何将数据导入到腾讯文档？
A: 
1. 点击 **"📥 导出 CSV"** 下载文件
2. 在腾讯文档中，点击 **"文件" → "导入" → "上传文件"**
3. 选择下载的 CSV 文件即可

### Q: 数据可以自动同步到云端吗？
A: 当前版本数据保存在本地。如果需要云端同步，可以：
- 定期导出 CSV 文件上传到云盘
- 使用浏览器的同步功能（如 Chrome 同步）
- 或使用第三方服务（需要额外开发）

### Q: 如何清空所有数据？
A: 
1. 在数据查看页面，点击 **"🗑️ 清空数据"** 按钮
2. 需要二次确认
3. 清空后数据无法恢复，请先导出备份

## 技术说明

### 数据存储
- 使用 `localStorage` API 存储数据
- Key: `weddingGuests`
- 格式：JSON 数组

### 数据查看
- 独立的 HTML 页面：`data-viewer.html`
- 读取相同的 `localStorage` 数据
- 实时显示和统计

### 浏览器兼容性
- Chrome ✅
- Firefox ✅
- Safari ✅
- Edge ✅
- 移动浏览器 ✅

## 优势

相比手动同步到腾讯文档，这个方案的优势：

1. ✅ **即时查看** - 无需手动操作，随时可以查看
2. ✅ **自动保存** - 来宾提交后自动保存，不会丢失
3. ✅ **数据统计** - 自动计算总人数、总来宾数等
4. ✅ **隐私保护** - 数据保存在本地，不上传到服务器
5. ✅ **易于导出** - 一键导出 CSV/JSON，方便导入其他系统
6. ✅ **响应式设计** - 支持各种设备查看

## 使用流程

### 对于来宾：
1. 填写表单并提交
2. 信息自动保存 ✅

### 对于管理员：
1. **查看数据**：点击 "📊 查看来宾信息" 按钮
2. **查看统计**：在数据查看页面查看统计信息
3. **导出备份**：定期导出 CSV 文件作为备份
4. **导入其他系统**：将 CSV 文件导入到腾讯文档、Excel 等

## 下一步

如果需要更多功能，可以考虑：
- 数据搜索和筛选
- 数据编辑和删除
- 数据导入功能
- 云端同步（需要后端支持）

